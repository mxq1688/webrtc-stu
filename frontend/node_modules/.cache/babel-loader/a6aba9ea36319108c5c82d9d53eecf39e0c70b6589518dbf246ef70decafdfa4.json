{"ast":null,"code":"var _jsxFileName = \"/Users/meng/stu/webrtc-stu/frontend/src/components/MeetingRoom.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useParams, useSearchParams, useNavigate } from 'react-router-dom';\nimport { v4 as uuidv4 } from 'uuid';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst WEBSOCKET_URL = 'ws://localhost:8080/ws';\nfunction MeetingRoom() {\n  _s();\n  const {\n    roomId\n  } = useParams();\n  const [searchParams] = useSearchParams();\n  const navigate = useNavigate();\n  const username = searchParams.get('username');\n  const userId = useRef(uuidv4());\n  const [localStream, setLocalStream] = useState(null);\n  const [remoteStreams, setRemoteStreams] = useState(new Map());\n  const [users, setUsers] = useState([]);\n  const [isAudioEnabled, setIsAudioEnabled] = useState(true);\n  const [isVideoEnabled, setIsVideoEnabled] = useState(true);\n  const [isConnected, setIsConnected] = useState(false);\n  const [error, setError] = useState('');\n  const localVideoRef = useRef();\n  const websocketRef = useRef();\n  const peerConnectionsRef = useRef(new Map());\n  const remoteVideoRefs = useRef(new Map());\n  const servers = {\n    iceServers: [{\n      urls: 'stun:stun.l.google.com:19302'\n    }, {\n      urls: 'stun:stun1.l.google.com:19302'\n    }]\n  };\n  useEffect(() => {\n    if (!username) {\n      navigate('/');\n      return;\n    }\n    initializeMedia();\n    connectWebSocket();\n    return () => {\n      cleanup();\n    };\n  }, [roomId, username]);\n  const initializeMedia = async () => {\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({\n        video: true,\n        audio: true\n      });\n      setLocalStream(stream);\n      if (localVideoRef.current) {\n        localVideoRef.current.srcObject = stream;\n      }\n    } catch (err) {\n      console.error('Ëé∑ÂèñÂ™í‰ΩìËÆæÂ§áÂ§±Ë¥•:', err);\n      setError('Êó†Ê≥ïËÆøÈóÆÊëÑÂÉèÂ§¥ÊàñÈ∫¶ÂÖãÈ£éÔºåËØ∑Ê£ÄÊü•ËÆæÂ§áÊùÉÈôê');\n    }\n  };\n  const connectWebSocket = () => {\n    const wsUrl = `${WEBSOCKET_URL}?userId=${userId.current}&roomId=${roomId}&username=${encodeURIComponent(username)}`;\n    console.log('üîó Â∞ùËØïËøûÊé•WebSocket:', wsUrl);\n    console.log('üîó ËøûÊé•ÂèÇÊï∞:', {\n      userId: userId.current,\n      roomId,\n      username\n    });\n    websocketRef.current = new WebSocket(wsUrl);\n    websocketRef.current.onopen = () => {\n      console.log('‚úÖ WebSocketËøûÊé•Â∑≤Âª∫Á´ã');\n      setIsConnected(true);\n      setError(''); // Ê∏ÖÈô§‰πãÂâçÁöÑÈîôËØØ\n    };\n    websocketRef.current.onmessage = async event => {\n      console.log('üì© Êî∂Âà∞WebSocketÊ∂àÊÅØ:', event.data);\n      try {\n        const message = JSON.parse(event.data);\n        await handleWebSocketMessage(message);\n      } catch (err) {\n        console.error('‚ùå Ëß£ÊûêÊ∂àÊÅØÂ§±Ë¥•:', err, event.data);\n      }\n    };\n    websocketRef.current.onclose = event => {\n      console.log('‚ùå WebSocketËøûÊé•Â∑≤ÂÖ≥Èó≠', {\n        code: event.code,\n        reason: event.reason\n      });\n      setIsConnected(false);\n\n      // Ê†πÊçÆÂÖ≥Èó≠‰ª£Á†ÅÊòæÁ§∫‰∏çÂêåÁöÑÈîôËØØ‰ø°ÊÅØ\n      if (event.code === 1006) {\n        setError('ËøûÊé•ÂºÇÂ∏∏ÂÖ≥Èó≠ÔºåËØ∑Ê£ÄÊü•ÁΩëÁªúÊàñÂà∑Êñ∞È°µÈù¢ÈáçËØï');\n      } else if (event.code === 1000) {\n        setError('ËøûÊé•Ê≠£Â∏∏ÂÖ≥Èó≠');\n      } else {\n        setError(`ËøûÊé•ÂÖ≥Èó≠ (‰ª£Á†Å: ${event.code}, ÂéüÂõ†: ${event.reason || 'Êú™Áü•'})`);\n      }\n    };\n    websocketRef.current.onerror = error => {\n      console.error('‚ùå WebSocketÈîôËØØ:', error);\n      setError('ÊúçÂä°Âô®ËøûÊé•Â§±Ë¥•ÔºåËØ∑Ê£ÄÊü•ÁΩëÁªúËøûÊé•');\n    };\n  };\n  const handleWebSocketMessage = async message => {\n    console.log('Êî∂Âà∞Ê∂àÊÅØ:', message);\n    switch (message.type) {\n      case 'user-list':\n        setUsers(message.data || []);\n        break;\n      case 'user-joined':\n        if (message.userId !== userId.current) {\n          setUsers(prev => [...prev, {\n            id: message.userId,\n            username: message.username\n          }]);\n          await createPeerConnection(message.userId);\n          await createOffer(message.userId);\n        }\n        break;\n      case 'user-left':\n        setUsers(prev => prev.filter(user => user.id !== message.userId));\n        closePeerConnection(message.userId);\n        break;\n      case 'offer':\n        await handleOffer(message);\n        break;\n      case 'answer':\n        await handleAnswer(message);\n        break;\n      case 'ice-candidate':\n        await handleIceCandidate(message);\n        break;\n    }\n  };\n  const createPeerConnection = async remoteUserId => {\n    const peerConnection = new RTCPeerConnection(servers);\n    peerConnectionsRef.current.set(remoteUserId, peerConnection);\n\n    // Ê∑ªÂä†Êú¨Âú∞ÊµÅ\n    if (localStream) {\n      localStream.getTracks().forEach(track => {\n        peerConnection.addTrack(track, localStream);\n      });\n    }\n\n    // Â§ÑÁêÜËøúÁ®ãÊµÅ\n    peerConnection.ontrack = event => {\n      console.log('Êî∂Âà∞ËøúÁ®ãÊµÅ:', event);\n      const [remoteStream] = event.streams;\n      setRemoteStreams(prev => new Map(prev.set(remoteUserId, remoteStream)));\n    };\n\n    // Â§ÑÁêÜICEÂÄôÈÄâËÄÖ\n    peerConnection.onicecandidate = event => {\n      if (event.candidate) {\n        sendMessage({\n          type: 'ice-candidate',\n          data: event.candidate,\n          targetUserId: remoteUserId\n        });\n      }\n    };\n    return peerConnection;\n  };\n  const createOffer = async remoteUserId => {\n    const peerConnection = peerConnectionsRef.current.get(remoteUserId);\n    if (!peerConnection) return;\n    try {\n      const offer = await peerConnection.createOffer();\n      await peerConnection.setLocalDescription(offer);\n      sendMessage({\n        type: 'offer',\n        data: offer,\n        targetUserId: remoteUserId\n      });\n    } catch (error) {\n      console.error('ÂàõÂª∫offerÂ§±Ë¥•:', error);\n    }\n  };\n  const handleOffer = async message => {\n    const {\n      userId: remoteUserId,\n      data: offer\n    } = message;\n    let peerConnection = peerConnectionsRef.current.get(remoteUserId);\n    if (!peerConnection) {\n      peerConnection = await createPeerConnection(remoteUserId);\n    }\n    try {\n      await peerConnection.setRemoteDescription(offer);\n      const answer = await peerConnection.createAnswer();\n      await peerConnection.setLocalDescription(answer);\n      sendMessage({\n        type: 'answer',\n        data: answer,\n        targetUserId: remoteUserId\n      });\n    } catch (error) {\n      console.error('Â§ÑÁêÜofferÂ§±Ë¥•:', error);\n    }\n  };\n  const handleAnswer = async message => {\n    const {\n      userId: remoteUserId,\n      data: answer\n    } = message;\n    const peerConnection = peerConnectionsRef.current.get(remoteUserId);\n    if (peerConnection) {\n      try {\n        await peerConnection.setRemoteDescription(answer);\n      } catch (error) {\n        console.error('Â§ÑÁêÜanswerÂ§±Ë¥•:', error);\n      }\n    }\n  };\n  const handleIceCandidate = async message => {\n    const {\n      userId: remoteUserId,\n      data: candidate\n    } = message;\n    const peerConnection = peerConnectionsRef.current.get(remoteUserId);\n    if (peerConnection) {\n      try {\n        await peerConnection.addIceCandidate(candidate);\n      } catch (error) {\n        console.error('Ê∑ªÂä†ICEÂÄôÈÄâËÄÖÂ§±Ë¥•:', error);\n      }\n    }\n  };\n  const sendMessage = message => {\n    if (websocketRef.current && websocketRef.current.readyState === WebSocket.OPEN) {\n      websocketRef.current.send(JSON.stringify(message));\n    }\n  };\n  const closePeerConnection = remoteUserId => {\n    const peerConnection = peerConnectionsRef.current.get(remoteUserId);\n    if (peerConnection) {\n      peerConnection.close();\n      peerConnectionsRef.current.delete(remoteUserId);\n    }\n    setRemoteStreams(prev => {\n      const newMap = new Map(prev);\n      newMap.delete(remoteUserId);\n      return newMap;\n    });\n  };\n  const toggleAudio = () => {\n    if (localStream) {\n      const audioTrack = localStream.getAudioTracks()[0];\n      if (audioTrack) {\n        audioTrack.enabled = !audioTrack.enabled;\n        setIsAudioEnabled(audioTrack.enabled);\n      }\n    }\n  };\n  const toggleVideo = () => {\n    if (localStream) {\n      const videoTrack = localStream.getVideoTracks()[0];\n      if (videoTrack) {\n        videoTrack.enabled = !videoTrack.enabled;\n        setIsVideoEnabled(videoTrack.enabled);\n      }\n    }\n  };\n  const leaveRoom = () => {\n    cleanup();\n    navigate('/');\n  };\n  const cleanup = () => {\n    if (localStream) {\n      localStream.getTracks().forEach(track => track.stop());\n    }\n    peerConnectionsRef.current.forEach(pc => pc.close());\n    peerConnectionsRef.current.clear();\n    if (websocketRef.current) {\n      websocketRef.current.close();\n    }\n  };\n  const copyRoomId = () => {\n    navigator.clipboard.writeText(roomId);\n    alert('ÊàøÈó¥IDÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø');\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"header\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: [\"\\u4F1A\\u8BAE\\u5BA4: \", roomId]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 307,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"\\u7528\\u6237: \", username, \" | \\u5728\\u7EBF\\u4EBA\\u6570: \", users.length + 1]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 308,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn\",\n        onClick: copyRoomId,\n        style: {\n          marginTop: '10px'\n        },\n        children: \"\\u590D\\u5236\\u623F\\u95F4ID\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 309,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 306,\n      columnNumber: 7\n    }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"error\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 314,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"video-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"video-wrapper\",\n        children: [/*#__PURE__*/_jsxDEV(\"video\", {\n          ref: localVideoRef,\n          className: \"video\",\n          autoPlay: true,\n          muted: true,\n          playsInline: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 319,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"video-overlay\",\n          children: [username, \" (\\u6211)\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 326,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 318,\n        columnNumber: 9\n      }, this), Array.from(remoteStreams.entries()).map(([userId, stream]) => {\n        const user = users.find(u => u.id === userId);\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"video-wrapper\",\n          children: [/*#__PURE__*/_jsxDEV(\"video\", {\n            className: \"video\",\n            autoPlay: true,\n            playsInline: true,\n            ref: el => {\n              if (el && stream) {\n                el.srcObject = stream;\n              }\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 336,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"video-overlay\",\n            children: (user === null || user === void 0 ? void 0 : user.username) || 'Unknown User'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 346,\n            columnNumber: 15\n          }, this)]\n        }, userId, true, {\n          fileName: _jsxFileName,\n          lineNumber: 335,\n          columnNumber: 13\n        }, this);\n      })]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 316,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"controls\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: `btn ${isAudioEnabled ? 'btn-success' : 'btn-danger'}`,\n        onClick: toggleAudio,\n        children: isAudioEnabled ? 'üé§ È∫¶ÂÖãÈ£éÂºÄÂêØ' : 'üé§ È∫¶ÂÖãÈ£éÂÖ≥Èó≠'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 355,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: `btn ${isVideoEnabled ? 'btn-success' : 'btn-danger'}`,\n        onClick: toggleVideo,\n        children: isVideoEnabled ? 'üìπ ÊëÑÂÉèÂ§¥ÂºÄÂêØ' : 'üìπ ÊëÑÂÉèÂ§¥ÂÖ≥Èó≠'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 362,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn btn-danger\",\n        onClick: leaveRoom,\n        children: \"\\u79BB\\u5F00\\u4F1A\\u8BAE\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 369,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 354,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"user-list\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        children: [\"\\u53C2\\u4F1A\\u4EBA\\u5458 (\", users.length + 1, \")\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 375,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"user-item\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"status-indicator\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 377,\n          columnNumber: 11\n        }, this), username, \" (\\u6211)\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 376,\n        columnNumber: 9\n      }, this), users.map(user => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"user-item\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"status-indicator\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 382,\n          columnNumber: 13\n        }, this), user.username]\n      }, user.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 381,\n        columnNumber: 11\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 374,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        textAlign: 'center',\n        marginTop: '20px',\n        color: isConnected ? '#51cf66' : '#ff6b6b'\n      },\n      children: isConnected ? 'üü¢ Â∑≤ËøûÊé•Âà∞ÊúçÂä°Âô®' : 'üî¥ ÊúçÂä°Âô®ËøûÊé•Êñ≠ÂºÄ'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 388,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 305,\n    columnNumber: 5\n  }, this);\n}\n_s(MeetingRoom, \"4K4WXkFWvG8sosqeuHR4DP0hQdY=\", false, function () {\n  return [useParams, useSearchParams, useNavigate];\n});\n_c = MeetingRoom;\nexport default MeetingRoom;\nvar _c;\n$RefreshReg$(_c, \"MeetingRoom\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useParams","useSearchParams","useNavigate","v4","uuidv4","jsxDEV","_jsxDEV","WEBSOCKET_URL","MeetingRoom","_s","roomId","searchParams","navigate","username","get","userId","localStream","setLocalStream","remoteStreams","setRemoteStreams","Map","users","setUsers","isAudioEnabled","setIsAudioEnabled","isVideoEnabled","setIsVideoEnabled","isConnected","setIsConnected","error","setError","localVideoRef","websocketRef","peerConnectionsRef","remoteVideoRefs","servers","iceServers","urls","initializeMedia","connectWebSocket","cleanup","stream","navigator","mediaDevices","getUserMedia","video","audio","current","srcObject","err","console","wsUrl","encodeURIComponent","log","WebSocket","onopen","onmessage","event","data","message","JSON","parse","handleWebSocketMessage","onclose","code","reason","onerror","type","prev","id","createPeerConnection","createOffer","filter","user","closePeerConnection","handleOffer","handleAnswer","handleIceCandidate","remoteUserId","peerConnection","RTCPeerConnection","set","getTracks","forEach","track","addTrack","ontrack","remoteStream","streams","onicecandidate","candidate","sendMessage","targetUserId","offer","setLocalDescription","setRemoteDescription","answer","createAnswer","addIceCandidate","readyState","OPEN","send","stringify","close","delete","newMap","toggleAudio","audioTrack","getAudioTracks","enabled","toggleVideo","videoTrack","getVideoTracks","leaveRoom","stop","pc","clear","copyRoomId","clipboard","writeText","alert","className","children","fileName","_jsxFileName","lineNumber","columnNumber","length","onClick","style","marginTop","ref","autoPlay","muted","playsInline","Array","from","entries","map","find","u","el","textAlign","color","_c","$RefreshReg$"],"sources":["/Users/meng/stu/webrtc-stu/frontend/src/components/MeetingRoom.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { useParams, useSearchParams, useNavigate } from 'react-router-dom';\nimport { v4 as uuidv4 } from 'uuid';\n\nconst WEBSOCKET_URL = 'ws://localhost:8080/ws';\n\nfunction MeetingRoom() {\n  const { roomId } = useParams();\n  const [searchParams] = useSearchParams();\n  const navigate = useNavigate();\n  \n  const username = searchParams.get('username');\n  const userId = useRef(uuidv4());\n  \n  const [localStream, setLocalStream] = useState(null);\n  const [remoteStreams, setRemoteStreams] = useState(new Map());\n  const [users, setUsers] = useState([]);\n  const [isAudioEnabled, setIsAudioEnabled] = useState(true);\n  const [isVideoEnabled, setIsVideoEnabled] = useState(true);\n  const [isConnected, setIsConnected] = useState(false);\n  const [error, setError] = useState('');\n\n  const localVideoRef = useRef();\n  const websocketRef = useRef();\n  const peerConnectionsRef = useRef(new Map());\n  const remoteVideoRefs = useRef(new Map());\n\n  const servers = {\n    iceServers: [\n      { urls: 'stun:stun.l.google.com:19302' },\n      { urls: 'stun:stun1.l.google.com:19302' }\n    ]\n  };\n\n  useEffect(() => {\n    if (!username) {\n      navigate('/');\n      return;\n    }\n    \n    initializeMedia();\n    connectWebSocket();\n    \n    return () => {\n      cleanup();\n    };\n  }, [roomId, username]);\n\n  const initializeMedia = async () => {\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({\n        video: true,\n        audio: true\n      });\n      setLocalStream(stream);\n      if (localVideoRef.current) {\n        localVideoRef.current.srcObject = stream;\n      }\n    } catch (err) {\n      console.error('Ëé∑ÂèñÂ™í‰ΩìËÆæÂ§áÂ§±Ë¥•:', err);\n      setError('Êó†Ê≥ïËÆøÈóÆÊëÑÂÉèÂ§¥ÊàñÈ∫¶ÂÖãÈ£éÔºåËØ∑Ê£ÄÊü•ËÆæÂ§áÊùÉÈôê');\n    }\n  };\n\n  const connectWebSocket = () => {\n    const wsUrl = `${WEBSOCKET_URL}?userId=${userId.current}&roomId=${roomId}&username=${encodeURIComponent(username)}`;\n    console.log('üîó Â∞ùËØïËøûÊé•WebSocket:', wsUrl);\n    console.log('üîó ËøûÊé•ÂèÇÊï∞:', { userId: userId.current, roomId, username });\n    \n    websocketRef.current = new WebSocket(wsUrl);\n\n    websocketRef.current.onopen = () => {\n      console.log('‚úÖ WebSocketËøûÊé•Â∑≤Âª∫Á´ã');\n      setIsConnected(true);\n      setError(''); // Ê∏ÖÈô§‰πãÂâçÁöÑÈîôËØØ\n    };\n\n    websocketRef.current.onmessage = async (event) => {\n      console.log('üì© Êî∂Âà∞WebSocketÊ∂àÊÅØ:', event.data);\n      try {\n        const message = JSON.parse(event.data);\n        await handleWebSocketMessage(message);\n      } catch (err) {\n        console.error('‚ùå Ëß£ÊûêÊ∂àÊÅØÂ§±Ë¥•:', err, event.data);\n      }\n    };\n\n    websocketRef.current.onclose = (event) => {\n      console.log('‚ùå WebSocketËøûÊé•Â∑≤ÂÖ≥Èó≠', { code: event.code, reason: event.reason });\n      setIsConnected(false);\n      \n      // Ê†πÊçÆÂÖ≥Èó≠‰ª£Á†ÅÊòæÁ§∫‰∏çÂêåÁöÑÈîôËØØ‰ø°ÊÅØ\n      if (event.code === 1006) {\n        setError('ËøûÊé•ÂºÇÂ∏∏ÂÖ≥Èó≠ÔºåËØ∑Ê£ÄÊü•ÁΩëÁªúÊàñÂà∑Êñ∞È°µÈù¢ÈáçËØï');\n      } else if (event.code === 1000) {\n        setError('ËøûÊé•Ê≠£Â∏∏ÂÖ≥Èó≠');\n      } else {\n        setError(`ËøûÊé•ÂÖ≥Èó≠ (‰ª£Á†Å: ${event.code}, ÂéüÂõ†: ${event.reason || 'Êú™Áü•'})`);\n      }\n    };\n\n    websocketRef.current.onerror = (error) => {\n      console.error('‚ùå WebSocketÈîôËØØ:', error);\n      setError('ÊúçÂä°Âô®ËøûÊé•Â§±Ë¥•ÔºåËØ∑Ê£ÄÊü•ÁΩëÁªúËøûÊé•');\n    };\n  };\n\n  const handleWebSocketMessage = async (message) => {\n    console.log('Êî∂Âà∞Ê∂àÊÅØ:', message);\n\n    switch (message.type) {\n      case 'user-list':\n        setUsers(message.data || []);\n        break;\n        \n      case 'user-joined':\n        if (message.userId !== userId.current) {\n          setUsers(prev => [...prev, { id: message.userId, username: message.username }]);\n          await createPeerConnection(message.userId);\n          await createOffer(message.userId);\n        }\n        break;\n        \n      case 'user-left':\n        setUsers(prev => prev.filter(user => user.id !== message.userId));\n        closePeerConnection(message.userId);\n        break;\n        \n      case 'offer':\n        await handleOffer(message);\n        break;\n        \n      case 'answer':\n        await handleAnswer(message);\n        break;\n        \n      case 'ice-candidate':\n        await handleIceCandidate(message);\n        break;\n    }\n  };\n\n  const createPeerConnection = async (remoteUserId) => {\n    const peerConnection = new RTCPeerConnection(servers);\n    peerConnectionsRef.current.set(remoteUserId, peerConnection);\n\n    // Ê∑ªÂä†Êú¨Âú∞ÊµÅ\n    if (localStream) {\n      localStream.getTracks().forEach(track => {\n        peerConnection.addTrack(track, localStream);\n      });\n    }\n\n    // Â§ÑÁêÜËøúÁ®ãÊµÅ\n    peerConnection.ontrack = (event) => {\n      console.log('Êî∂Âà∞ËøúÁ®ãÊµÅ:', event);\n      const [remoteStream] = event.streams;\n      setRemoteStreams(prev => new Map(prev.set(remoteUserId, remoteStream)));\n    };\n\n    // Â§ÑÁêÜICEÂÄôÈÄâËÄÖ\n    peerConnection.onicecandidate = (event) => {\n      if (event.candidate) {\n        sendMessage({\n          type: 'ice-candidate',\n          data: event.candidate,\n          targetUserId: remoteUserId\n        });\n      }\n    };\n\n    return peerConnection;\n  };\n\n  const createOffer = async (remoteUserId) => {\n    const peerConnection = peerConnectionsRef.current.get(remoteUserId);\n    if (!peerConnection) return;\n\n    try {\n      const offer = await peerConnection.createOffer();\n      await peerConnection.setLocalDescription(offer);\n      \n      sendMessage({\n        type: 'offer',\n        data: offer,\n        targetUserId: remoteUserId\n      });\n    } catch (error) {\n      console.error('ÂàõÂª∫offerÂ§±Ë¥•:', error);\n    }\n  };\n\n  const handleOffer = async (message) => {\n    const { userId: remoteUserId, data: offer } = message;\n    \n    let peerConnection = peerConnectionsRef.current.get(remoteUserId);\n    if (!peerConnection) {\n      peerConnection = await createPeerConnection(remoteUserId);\n    }\n\n    try {\n      await peerConnection.setRemoteDescription(offer);\n      const answer = await peerConnection.createAnswer();\n      await peerConnection.setLocalDescription(answer);\n      \n      sendMessage({\n        type: 'answer',\n        data: answer,\n        targetUserId: remoteUserId\n      });\n    } catch (error) {\n      console.error('Â§ÑÁêÜofferÂ§±Ë¥•:', error);\n    }\n  };\n\n  const handleAnswer = async (message) => {\n    const { userId: remoteUserId, data: answer } = message;\n    const peerConnection = peerConnectionsRef.current.get(remoteUserId);\n    \n    if (peerConnection) {\n      try {\n        await peerConnection.setRemoteDescription(answer);\n      } catch (error) {\n        console.error('Â§ÑÁêÜanswerÂ§±Ë¥•:', error);\n      }\n    }\n  };\n\n  const handleIceCandidate = async (message) => {\n    const { userId: remoteUserId, data: candidate } = message;\n    const peerConnection = peerConnectionsRef.current.get(remoteUserId);\n    \n    if (peerConnection) {\n      try {\n        await peerConnection.addIceCandidate(candidate);\n      } catch (error) {\n        console.error('Ê∑ªÂä†ICEÂÄôÈÄâËÄÖÂ§±Ë¥•:', error);\n      }\n    }\n  };\n\n  const sendMessage = (message) => {\n    if (websocketRef.current && websocketRef.current.readyState === WebSocket.OPEN) {\n      websocketRef.current.send(JSON.stringify(message));\n    }\n  };\n\n  const closePeerConnection = (remoteUserId) => {\n    const peerConnection = peerConnectionsRef.current.get(remoteUserId);\n    if (peerConnection) {\n      peerConnection.close();\n      peerConnectionsRef.current.delete(remoteUserId);\n    }\n    setRemoteStreams(prev => {\n      const newMap = new Map(prev);\n      newMap.delete(remoteUserId);\n      return newMap;\n    });\n  };\n\n  const toggleAudio = () => {\n    if (localStream) {\n      const audioTrack = localStream.getAudioTracks()[0];\n      if (audioTrack) {\n        audioTrack.enabled = !audioTrack.enabled;\n        setIsAudioEnabled(audioTrack.enabled);\n      }\n    }\n  };\n\n  const toggleVideo = () => {\n    if (localStream) {\n      const videoTrack = localStream.getVideoTracks()[0];\n      if (videoTrack) {\n        videoTrack.enabled = !videoTrack.enabled;\n        setIsVideoEnabled(videoTrack.enabled);\n      }\n    }\n  };\n\n  const leaveRoom = () => {\n    cleanup();\n    navigate('/');\n  };\n\n  const cleanup = () => {\n    if (localStream) {\n      localStream.getTracks().forEach(track => track.stop());\n    }\n    \n    peerConnectionsRef.current.forEach(pc => pc.close());\n    peerConnectionsRef.current.clear();\n    \n    if (websocketRef.current) {\n      websocketRef.current.close();\n    }\n  };\n\n  const copyRoomId = () => {\n    navigator.clipboard.writeText(roomId);\n    alert('ÊàøÈó¥IDÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø');\n  };\n\n  return (\n    <div className=\"container\">\n      <div className=\"header\">\n        <h1>‰ºöËÆÆÂÆ§: {roomId}</h1>\n        <p>Áî®Êà∑: {username} | Âú®Á∫ø‰∫∫Êï∞: {users.length + 1}</p>\n        <button className=\"btn\" onClick={copyRoomId} style={{ marginTop: '10px' }}>\n          Â§çÂà∂ÊàøÈó¥ID\n        </button>\n      </div>\n\n      {error && <div className=\"error\">{error}</div>}\n\n      <div className=\"video-container\">\n        {/* Êú¨Âú∞ËßÜÈ¢ë */}\n        <div className=\"video-wrapper\">\n          <video\n            ref={localVideoRef}\n            className=\"video\"\n            autoPlay\n            muted\n            playsInline\n          />\n          <div className=\"video-overlay\">\n            {username} (Êàë)\n          </div>\n        </div>\n\n        {/* ËøúÁ®ãËßÜÈ¢ë */}\n        {Array.from(remoteStreams.entries()).map(([userId, stream]) => {\n          const user = users.find(u => u.id === userId);\n          return (\n            <div key={userId} className=\"video-wrapper\">\n              <video\n                className=\"video\"\n                autoPlay\n                playsInline\n                ref={(el) => {\n                  if (el && stream) {\n                    el.srcObject = stream;\n                  }\n                }}\n              />\n              <div className=\"video-overlay\">\n                {user?.username || 'Unknown User'}\n              </div>\n            </div>\n          );\n        })}\n      </div>\n\n      <div className=\"controls\">\n        <button\n          className={`btn ${isAudioEnabled ? 'btn-success' : 'btn-danger'}`}\n          onClick={toggleAudio}\n        >\n          {isAudioEnabled ? 'üé§ È∫¶ÂÖãÈ£éÂºÄÂêØ' : 'üé§ È∫¶ÂÖãÈ£éÂÖ≥Èó≠'}\n        </button>\n        \n        <button\n          className={`btn ${isVideoEnabled ? 'btn-success' : 'btn-danger'}`}\n          onClick={toggleVideo}\n        >\n          {isVideoEnabled ? 'üìπ ÊëÑÂÉèÂ§¥ÂºÄÂêØ' : 'üìπ ÊëÑÂÉèÂ§¥ÂÖ≥Èó≠'}\n        </button>\n        \n        <button className=\"btn btn-danger\" onClick={leaveRoom}>\n          Á¶ªÂºÄ‰ºöËÆÆ\n        </button>\n      </div>\n\n      <div className=\"user-list\">\n        <h3>ÂèÇ‰ºö‰∫∫Âëò ({users.length + 1})</h3>\n        <div className=\"user-item\">\n          <div className=\"status-indicator\"></div>\n          {username} (Êàë)\n        </div>\n        {users.map(user => (\n          <div key={user.id} className=\"user-item\">\n            <div className=\"status-indicator\"></div>\n            {user.username}\n          </div>\n        ))}\n      </div>\n\n      <div style={{ textAlign: 'center', marginTop: '20px', color: isConnected ? '#51cf66' : '#ff6b6b' }}>\n        {isConnected ? 'üü¢ Â∑≤ËøûÊé•Âà∞ÊúçÂä°Âô®' : 'üî¥ ÊúçÂä°Âô®ËøûÊé•Êñ≠ÂºÄ'}\n      </div>\n    </div>\n  );\n}\n\nexport default MeetingRoom; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}